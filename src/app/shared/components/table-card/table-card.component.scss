/* Import the global mixins */
@use '../../../../styles/mixins' as m;

:host {
  display: flex;
  flex-direction: column;
  height: 100%;
  min-height: 0;
}

.table-card {
  background-color: var(--surface-card);
  /* Semantic Variable */
  border-radius: var(--border-radius-lg);
  padding: var(--spacing-md);
  box-shadow: var(--box-shadow-md);
  display: flex;
  flex-direction: column;
  height: 100%;
  overflow: hidden;
  position: relative;

  /* Subtle border for dark mode definition */
  border: 1px solid transparent;

  [data-theme='dark'] & {
    border-color: var(--border-color);
  }

  @media (max-width: 768px) {
    padding: var(--spacing-sm);
    border-radius: var(--border-radius-md);
  }

  @media (max-width: 480px) {
    padding: var(--spacing-sm);
  }


}

.card-header {
  flex-shrink: 0;
  margin-bottom: var(--spacing-md);
  padding-bottom: var(--spacing-sm);
  border-bottom: 1px solid var(--border-color);
  display: flex;
  align-items: center;
  justify-content: space-between;
  gap: var(--spacing-sm);

  @media (max-width: 480px) {
    margin-bottom: var(--spacing-sm);
    padding-bottom: var(--spacing-sm);
  }
}

.card-title-wrapper {
  display: flex;
  align-items: center;
  flex: 1;
  min-width: 0;
  gap: var(--spacing-sm);
}

.card-title {
  font-size: 1.125rem;
  font-weight: 600;
  color: var(--text-primary);
  margin: 0;
  display: flex;
  align-items: center;
  gap: var(--spacing-sm);
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;

  i {
    font-size: 1rem;
    flex-shrink: 0;

    &.icon-info {
      color: var(--color-info);
    }

    &.icon-warning {
      color: var(--color-warning);
    }

    &.icon-danger {
      color: var(--color-danger);
    }

    &.icon-success {
      color: var(--color-success);
    }

    &.text-teal {
      color: var(--teal-blue);
    }
  }

  @media (max-width: 768px) {
    font-size: 1rem;
  }

  @media (max-width: 480px) {
    font-size: 0.9375rem;
    gap: var(--spacing-xs);

    i {
      font-size: 0.875rem;
    }
  }
}

/* Skeleton Title for Loading State */
.skeleton-title {
  width: 150px;
  height: 1.6875rem;
  /* Matches line-height of .card-title (1.125rem * 1.5) */
  border-radius: 4px;
  background-color: var(--gray-100);
  animation: pulse 1.5s infinite ease-in-out;

  @media (max-width: 768px) {
    height: 1.5rem;
    /* Matches 1rem * 1.5 */
    width: 120px;
  }

  @media (max-width: 480px) {
    height: 1.40625rem;
    /* Matches 0.9375rem * 1.5 */
    width: 100px;
  }
}

.skeleton {
  background-color: var(--gray-100);
  animation: pulse 1.5s infinite ease-in-out;
}

.header-controls {
  display: flex;
  align-items: center;
  gap: var(--spacing-sm);
  flex-shrink: 0;
  margin-left: var(--spacing-sm);

  @media (max-width: 480px) {
    margin-left: var(--spacing-xs);
    gap: var(--spacing-xs);
  }
}

.btn-icon-action {
  background: transparent;
  border: 1px solid var(--border-color);
  border-radius: var(--border-radius-sm);
  width: 32px;
  height: 32px;
  display: flex;
  align-items: center;
  justify-content: center;
  cursor: pointer;

  /* Use global mixin for consistent hover/focus/disabled states */
  @include m.icon-btn-interactions;

  i {
    font-size: 1rem;
  }
}

.text-success {
  color: var(--color-success);
}

.text-teal {
  color: var(--teal-blue);
}

.card-body {
  flex-grow: 1;
  min-height: 0;
  position: relative;
  display: flex;
  flex-direction: column;

  /* Override reusable table host to fit perfectly inside the card body */
  ::ng-deep app-reusable-table {
    height: 100%;
    display: flex;
    flex-direction: column;

    .reusable-table-wrapper {
      border: none;
      box-shadow: none;
      border-radius: 0;
      background: transparent;
      height: 100%;
      display: flex;
      flex-direction: column;
    }

    .table-container {
      flex: 1;
      height: 100%;
      display: flex;
      flex-direction: column;
    }

    /* Force table to take full height to push empty state to center if needed, 
       but normally we just want the container to fill. 
       If we want vertical centering of 'empty state', we need the table to fill 
       and the no-data-row to fill. */
    table.mat-table {
      flex: 1;
      min-height: 100%;
    }

    /* Ensure empty state centering */
    .mat-no-data-row td {
      height: 100%;
      vertical-align: middle;
      border-bottom: none;
    }

    .no-data-container {
      height: 100%;
      display: flex;
      flex-direction: column;
      justify-content: center;
      align-items: center;
    }
  }
}

/* Internal Skeleton Styles */
.skeleton-container {
  padding: var(--spacing-sm);
  display: flex;
  flex-direction: column;
  gap: var(--spacing-md);
  height: 100%;

  .skeleton-header {
    height: 40px;
    background-color: var(--gray-100);
    /* Adaptive Gray */
    border-radius: 4px;
    animation: pulse 1.5s infinite ease-in-out;
  }

  .skeleton-row {
    height: 30px;
    background-color: var(--gray-50);
    /* Adaptive Gray */
    border-radius: 4px;
    animation: pulse 1.5s infinite ease-in-out;
    animation-delay: 0.1s;

    &:nth-child(3) {
      animation-delay: 0.2s;
    }

    &:nth-child(4) {
      animation-delay: 0.3s;
    }

    &:nth-child(5) {
      animation-delay: 0.4s;
    }
  }
}

@keyframes pulse {
  0% {
    opacity: 0.6;
  }

  50% {
    opacity: 1;
  }

  100% {
    opacity: 0.6;
  }
}