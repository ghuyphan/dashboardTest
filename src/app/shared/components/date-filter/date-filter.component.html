<div class="filter-card" [class.is-loading]="isLoading()">
  <div class="filter-inputs" [class.has-queue-filter]="showQueueFilter()">
    <div class="filter-group">
      <label for="fromDate">Từ ngày</label>
      <div class="input-wrapper">
        <input
          id="fromDate"
          class="form-control-date"
          [matDatepicker]="pickerFrom"
          [value]="fromDateObj()"
          (dateChange)="onDateChange('from', $event.value)"
          [max]="fromMaxDate()"
          [disabled]="isLoading()"
          placeholder="dd/mm/yyyy"
          readonly
          (click)="pickerFrom.open()" />
        <mat-datepicker-toggle
          [for]="pickerFrom"
          class="custom-toggle"
          [disabled]="isLoading()"></mat-datepicker-toggle>
        <mat-datepicker #pickerFrom [touchUi]="isMobile()"></mat-datepicker>
      </div>
    </div>

    <div class="filter-group">
      <label for="toDate">Đến ngày</label>
      <div class="input-wrapper">
        <input
          id="toDate"
          class="form-control-date"
          [matDatepicker]="pickerTo"
          [value]="toDateObj()"
          (dateChange)="onDateChange('to', $event.value)"
          [min]="toMinDate()"
          [max]="toMaxDate()"
          [disabled]="isLoading()"
          placeholder="dd/mm/yyyy"
          readonly
          (click)="pickerTo.open()" />
        <mat-datepicker-toggle
          [for]="pickerTo"
          class="custom-toggle"
          [disabled]="isLoading()"></mat-datepicker-toggle>
        <mat-datepicker #pickerTo [touchUi]="isMobile()"></mat-datepicker>
      </div>
    </div>
    @if (showQueueFilter()) {
      <div class="filter-group">
        <label for="queueSelect">Hàng đợi</label>
        <div class="input-wrapper custom-dropdown-wrapper">
          <mat-form-field
            appearance="outline"
            class="full-width-field dense-form-field"
            subscriptSizing="dynamic">
            <mat-select
              [value]="selectedQueue()"
              (selectionChange)="onQueueChange($event.value)"
              placeholder="Chọn hàng đợi"
              panelClass="dynamic-form-select-panel"
              [disabled]="isLoading()">
              @for (queue of queues(); track queue.SCREEN_ID) {
                <mat-option [value]="queue.SCREEN_ID">{{
                  queue.NAME
                }}</mat-option>
              }
            </mat-select>
          </mat-form-field>
        </div>
      </div>
    }
  </div>

  @if (showQuickRanges()) {
    <div
      class="quick-actions-container"
      [class.can-scroll-left]="canScrollLeft()"
      [class.can-scroll-right]="canScrollRight()">
      <div
        class="quick-actions-scroll"
        #quickActionsScroll
        (scroll)="onQuickActionsScroll()">
        @for (range of quickRanges; track range.key; let i = $index) {
          <button
            type="button"
            class="btn-pill"
            [class.active]="activeRange() === range.key"
            (click)="setRange(range.key, true)"
            [disabled]="isLoading()"
            [appTooltip]="range.label + ' (Alt + ' + (i + 1) + ')'">
            {{ range.label }}
          </button>
        }
      </div>
    </div>
  }

  <div class="action-buttons">
    <button
      type="button"
      class="btn btn-primary"
      (click)="applyFilter()"
      [disabled]="isLoading()"
      [appTooltip]="'Áp dụng bộ lọc (Alt + Enter)'">
      @if (isLoading()) {
        <i class="fas fa-spinner fa-spin"></i>
      } @else {
        <i class="fas fa-filter"></i>
      }
      <span>{{ buttonLabel() }}</span>
    </button>
  </div>
</div>
