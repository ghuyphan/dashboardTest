<div class="page-container">
  <div class="page-content">
    
    <div class="widget-section" *ngIf="isLoading && widgetData.length === 0; else widgetsLoaded">
      <div class="widget-grid">
        <div class="widget-skeleton" *ngFor="let i of [1,2,3,4,5,6,7]"></div>
      </div>
    </div>
    
    <ng-template #widgetsLoaded>
      <div class="widget-section">
        <div class="widget-grid">
          <app-widget-card 
            *ngFor="let widget of widgetData; trackBy: trackByWidgetId"
            [icon]="widget.icon"
            [title]="widget.title"
            [value]="widget.value"
            [caption]="widget.caption"
            [accentColor]="widget.accentColor">
          </app-widget-card>
        </div>
      </div>
    </ng-template>

    <app-chart-card 
      title="Tình Hình Sử Dụng Giường Bệnh" 
      icon="fas fa-bed-pulse" 
      iconClass="icon-info"
      [isLoading]="isLoading"
      [chartOptions]="chartOptions">
      
      <div 
        header-actions
        class="refresh-control"
        (click)="loadData()" 
        [class.loading]="isLoading"
        [attr.aria-label]="isLoading ? 'Loading data' : 'Refresh data'"
        role="button"
        tabindex="0"
        (keydown.enter)="loadData()"
        (keydown.space)="loadData()">
        
        <div class="refresh-icon">
          <i class="fas" [ngClass]="{'fa-sync': !isLoading, 'fa-spinner fa-spin': isLoading}"></i>
        </div>
        <span class="refresh-text" *ngIf="currentDateTime">
          Cập nhập: {{ currentDateTime }}
        </span>
      </div>

    </app-chart-card>

  </div>
</div>