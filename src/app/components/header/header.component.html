<header class="dashboard-header">
  <div class="header-left-controls">
    
    <button
      class="header-icon-btn mobile-sidebar-toggle"
      (click)="onMobileToggleClick()"
      aria-label="Toggle sidebar"
    >
      <svg width="20" height="20" viewBox="0 0 100 100" xmlns="http://www.w3.org/2000/svg" style="display: block">
        <rect y="10" width="100" height="80" rx="15" ry="15" fill="#1E3A6B" />
        <rect x="10" y="25" width="25" height="10" rx="5" ry="5" fill="#fff" />
        <rect x="10" y="40" width="25" height="10" rx="5" ry="5" fill="#fff" />
        <rect x="10" y="55" width="25" height="10" rx="5" ry="5" fill="#fff" />
        <rect x="42" y="20" width="50" height="60" rx="5" ry="5" fill="#fff" />
      </svg>
    </button>
    
    @if (showBackButton()) {
      <button
        class="header-icon-btn header-back-btn"
        (click)="onBackClick()"
        aria-label="Go back"
      >
        <i class="fas fa-arrow-left"></i>
      </button>
    }

    <h2 class="header-title">{{ currentScreenName() }}</h2>
  </div>

  @if (showSearchBar()) {
    <div class="header-search-container">
      <div class="search-icon-wrapper">
        <i class="fas fa-search search-icon"></i>
      </div>
      <input
        type="text"
        class="header-search-input"
        placeholder="Tìm kiếm..."
        [value]="searchTerm"
        (input)="onSearchChange($event)"
        aria-label="Search"
      />
      @if (searchTerm) {
        <button
          type="button"
          class="search-clear-btn"
          (click)="onClearSearch()"
          aria-label="Clear search"
        >
          <i class="fas fa-times"></i>
        </button>
      }
    </div>
  }

  <div class="header-right-controls">
    @if (currentUser()) {
      <div class="user-menu">
        
        <button class="user-menu-toggle" [matMenuTriggerFor]="userMenu">
          <div class="header-avatar-initials">{{ userInitials() }}</div>
          <i class="fas fa-chevron-down chevron-icon"></i>
        </button>
  
        <mat-menu #userMenu="matMenu" class="header-user-menu-panel" xPosition="before">
          
          <div class="menu-section-wrapper" (click)="$event.stopPropagation()">
            <div class="dropdown-profile-header">
              <div class="dropdown-avatar-initials">{{ userInitials() }}</div>
              <div class="dropdown-profile-text">
                <span class="username">{{ currentUser()?.fullName }}</span>
                <span class="user-role">{{ rolesDisplay() }}</span>
              </div>
            </div>
          </div>
  
          <div class="menu-items-wrapper">
            <button mat-menu-item (click)="onSettingsClick()" class="custom-menu-item">
              <div class="menu-icon-bg"><i class="fas fa-gear"></i></div>
              <span>Cài đặt</span>
            </button>
  
            <button mat-menu-item (click)="onSupportClick()" class="custom-menu-item">
              <div class="menu-icon-bg"><i class="fas fa-question-circle"></i></div>
              <span>Hỗ trợ</span>
            </button>
  
            <button mat-menu-item (click)="onLogoutClick()" class="custom-menu-item logout-item">
              <div class="menu-icon-bg"><i class="fas fa-sign-out-alt"></i></div>
              <span>Đăng xuất</span>
            </button>
          </div>
  
        </mat-menu>
      </div>
    }
  </div>
</header>