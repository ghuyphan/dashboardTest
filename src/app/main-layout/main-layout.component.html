<div class="dashboard-container">
  <app-sidebar
    [navItems]="navItems"
    [isOpen]="isSidebarOpen"
    (toggleSidebar)="toggleSidebar()"
  ></app-sidebar>

  <div
    class="sidebar-backdrop"
    [class.show]="isSidebarOpen"
    (click)="toggleSidebar()"
  ></div>


  <div class="main-panel" [ngClass]="{ 'collapsed': !isSidebarOpen }">
    <app-header
      [currentUser]="currentUser"
      [userInitials]="userInitials"
      [rolesDisplay]="rolesDisplay"
      [currentScreenName]="currentScreenName"
      [showSearchBar]="showSearchBar" 
      [showBackButton]="showBackButton" 
      (sidebarToggled)="toggleSidebar()"
      (logoutClicked)="logout()"
      (searchChanged)="onSearchTermChanged($event)"
      (backClicked)="onBackClicked()" 
    ></app-header>

    <main class="dashboard-content">
      <div *ngIf="isContentLoaded; else loading" class="content-fade-wrapper">
        <router-outlet></router-outlet>
      </div>

      <ng-template #loading>
        <div class="initial-loading-spinner">
          <p>Loading...</p> 
        </div>
      </ng-template>
    </main>
    
    <app-action-footer></app-action-footer>
  </div>
</div>